---
title: 压缩HTTP请求和响应数据的方法
date: 2021-10-3
author: Justin
top: false
cover: false
categories: HTTP
tags:
  - HTTP
---

>在客户端和浏览器进行信息交互的时候，如果直接传输文件，可能会消耗太多的流量，通过压缩技术可以为我们节省很多流量，下面来介绍下HTTP响应数据是如何进行压缩的。

## HTTP响应数据压缩
### 使用Gzip压缩文本

>浏览器和服务器之间会使用主动协商机制，浏览器向服务器发送请求的时候，其请求标头中会含有Accept-Encoding字段，其中包含了客户端支持的压缩算法，以及各自的优先级，服务器则从中选择一种，使用该算法对响应的消息主体进行压缩，并且发送Content-Encoding首部来告知浏览器它选择了哪一种压缩算法。

* 客户端请求标头实例

![](https://img-blog.csdnimg.cn/img_convert/170f3bab09835a36465cccc4a2089783.png)

* 服务器端响应标头实例

![](https://img-blog.csdnimg.cn/img_convert/8a8f9edf06e23314e9486b64dd89d342.png)

## HTTP请求数据的压缩

### 头部数据压缩
>HTTP协议是不支持头信息压缩的，但是HTTP2引入了头信息压缩机制，一方面，头信息可以使用gzip或compress压缩后再发送，另一方面，客户端和服务器同时维护一张头信息表，所有字段都会存入这个表，生成一个索引号，以后就不发送同样字段了，只发送索引号。

### 请求体数据压缩
>上文中，我们提到了HTTP协议中的Accept-Encoding/Content-Encoding机制，这套机制可以很好地用于文本类响应正文地压缩，可以大幅度地减少网络传输，从而一直被广泛使用，但HTTP请求地发起方，无法事先知晓要访问地服务端是否支持解压，所以现阶段地浏览器没有压缩请求正文。

>有一些通讯协议基于HTTP做了拓展，他们地客户端和服务端是专用地，可以放心大胆地压缩请求正文，例如WebDAV客户端就是这样地。

>实际地Web项目中，会存在请求正文非常大的场景，例如发表长篇博客，上报用于调试的网络数据等待，这些数据如果能在本地压缩后再提交，就可以节省网络流量、减少传输时间。下面将介绍如何对HTTP请求正文进行压缩，包含如何再服务端解压、如何在客户端压缩两部分。

>下面是三种常见的文本压缩方式

1. DEFLATE
2. ZLIB
3. GZIP

